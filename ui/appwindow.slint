import { Theme, Icons } from "./theme.slint";
import { Logic } from "./logic.slint";
import { Store } from "./store.slint";
import { Util } from "./util.slint";
import { Panel } from "./panel/panel.slint";
import { Message, IconsDialog, OkCancelDialog, Blanket } from "./base/widgets.slint";

export component AppWindow inherits Window {
    default-font-size: Theme.default-font-size;
    default-font-family: Theme.default-font-family;
    preferred-width: Theme.default-width;
    preferred-height: Theme.default-height;

    width: Theme.default-width;
    height: Theme.default-height;

    background: Theme.base-background-dark;
    icon: Icons.brand;
    title: "rssbox";

    init => { }

    Rectangle {
        background: Theme.base-background-light;
        panel := Panel { }
    }

    modal := Rectangle {
        if oc-dialog.visible || icons-dialog.visible : Blanket { }

        icons-dialog := IconsDialog {
            select-index(index) => { panel.icon-index = index; }
        }

        oc-dialog := OkCancelDialog {
            width: Math.min(root.width * 0.95, 380px);
        }
    }

    msg := Message {
        x: root.width / 2 - self.width / 2; y: 50px;
        inner-max-width: root.width * 80%;
        text: Store.message.text;
        type: Store.message.text-type;
        clicked => { Logic.copy-to-clipboard(self.text); }
    }
}

export { Util, Logic, Store }
